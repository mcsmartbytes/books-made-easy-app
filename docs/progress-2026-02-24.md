# Progress Report — February 24, 2026

## Database Migration: Neon → Turso (libSQL)

### Completed
- **Migrated database from Neon PostgreSQL to Turso (libSQL)**
  - Replaced `@neondatabase/serverless` with `@libsql/client`
  - Created `src/lib/turso.ts` — Turso client connection + `execSql()` helper
  - Created `src/utils/tursoAdmin.ts` — Full Supabase-compatible query builder (select, insert, update, upsert, delete, relations/joins)
  - Updated `src/utils/supabaseAdmin.ts` to re-export Turso as drop-in replacement
  - Created `turso/schema.sql` — Complete SQLite schema (29 tables with indexes and triggers)
  - All 31+ API routes work through the `supabaseAdmin` compatibility layer — zero changes needed

- **Cleaned up legacy dependencies**
  - Deleted `src/utils/neonAdmin.ts` (unused)
  - Removed `@supabase/supabase-js`, `@neondatabase/serverless`, `drizzle-orm`, `@auth/drizzle-adapter` from package.json
  - Migrated `src/app/api/seed-demo/route.ts` from direct Supabase SDK to tursoAdmin

- **Set up Turso production database**
  - Database: `books-made-easy` on Turso (AWS us-west-2)
  - URL: `libsql://books-made-easy-mcsmartbytes.aws-us-west-2.turso.io`
  - Applied full schema (103 SQL statements, 29 tables)
  - Verified all CRUD operations working end-to-end

- **Fixed build issues**
  - Added `target: "es2017"` to `tsconfig.json` to fix Set iteration error
  - Renamed unused `paramOffset` to `_paramOffset` in tursoAdmin.ts
  - Fixed `company_settings` API route to strip `_upsert`/`_onConflict` client control fields

- **WSL2 environment setup**
  - Configured `vmIdleTimeout=-1` in `.wslconfig` to prevent idle shutdown
  - Mounted D: drive for development
  - Set `git config --global core.fileMode false` for NTFS permission noise

### Verified Working
- Signup flow → creates user in Turso
- Login via NextAuth credentials
- Onboarding (company name, industry selection, category + account seeding)
- Dashboard loads with real data
- Customer CRUD (create, read, update, delete)
- All API routes responding correctly

### Commits
- `24c374a` — Migrate database from Neon to Turso (libSQL)
- `2899965` — Fix company_settings API to strip client-side control fields

### Project Cleanup
- Deleted duplicate project directories:
  - `/mnt/d/projects/active/books_made_easy` (13 GB old copy)
  - `/mnt/d/projects/active/books_your_way` (88 MB variant)
- Single source of truth: `/mnt/d/projects/active/books-made-easy-app`

### Next Steps
- Push changes to remote repository
- Update Vercel environment variables for Turso
- PDF generation for invoices/reports
- Multi-client support for bookkeeping company pitch
- Tax preparation module (1040, Schedule C, quarterly estimates)
